datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model Member {
  id                BigInt             @id @default(autoincrement())
  email             String             @unique @db.VarChar(50)
  nickname          String             @unique @db.VarChar(20)
  password          String             @db.VarChar(100)
  phoneNumber       String?            @map(name: "phone_number") @db.VarChar(20)
  profile           String             @db.VarChar(100)
  address           String?            @db.VarChar(50)
  name              String?            @db.VarChar(10)
  career            String?            @db.VarChar(50)
  description       String?            @db.VarChar(100)
  role              Role               @default(MEMBER)
  consoleBoards     ConsoleBoard[]
  communityBoards   CommunityBoard[]
  consoleComments   ConsoleComment[]
  communityComments CommunityComment[]
  likes             Likes[]

  @@map("member")
}

model ConsoleBoard {
  id              BigInt           @id @default(autoincrement())
  title           String           @db.VarChar(50)
  content         String
  createdAt       DateTime         @map(name: "create_at")
  updatedAt       DateTime         @map(name: "updated_at")
  memberId        BigInt?          @map(name: "member_id")
  member          Member?          @relation(fields: [memberId], references: [id])
  consoleComments ConsoleComment[]

  @@map("console_board")
}

model CommunityBoard {
  id                BigInt             @id @default(autoincrement())
  title             String             @db.VarChar(50)
  content           String
  createdAt         DateTime           @map(name: "created_at")
  updatedAt         DateTime           @map(name: "updated_at")
  memberId          BigInt?            @map(name: "member_id")
  member            Member?            @relation(fields: [memberId], references: [id])
  communityComments CommunityComment[]
  likes             Likes[]

  @@map("community_board")
}

model ConsoleComment {
  id        BigInt       @id @default(autoincrement())
  content   String
  createdAt DateTime     @map(name: "created_at")
  postId    BigInt       @map(name: "post_id")
  memberId  BigInt       @map(name: "member_id")
  post      ConsoleBoard @relation(fields: [postId], references: [id])
  member    Member       @relation(fields: [memberId], references: [id])

  @@map("console_comment")
}

model CommunityComment {
  id        BigInt         @id @default(autoincrement())
  content   String
  createdAt DateTime       @map(name: "created_at")
  postId    BigInt         @map(name: "post_id")
  memberId  BigInt         @map(name: "member_id")
  post      CommunityBoard @relation(fields: [postId], references: [id])
  member    Member         @relation(fields: [memberId], references: [id])

  @@map("community_comment")
}

model Likes {
  memberId BigInt         @map(name: "member_id")
  postId   BigInt         @map(name: "post_id")
  member   Member         @relation(fields: [memberId], references: [id])
  post     CommunityBoard @relation(fields: [postId], references: [id])

  @@id([memberId, postId])
  @@map("likes")
}

enum Role {
  MEMBER
  LISTENER
}
